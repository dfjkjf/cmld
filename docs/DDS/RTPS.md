---
sort: 2
---

# RTPS

文档的大纲如下：

1. **封面和版权信息**
   - 包含文档标题、版本号、发布日期、版权声明、版权所有者和使用条款。

2. **前言**
   - 介绍文档的目的、范围以及与其他OMG规范的关系。

3. **使用条款**
   - 详细说明使用该规范的法律条款，包括版权声明、许可证授予、专利信息和免责声明。

4. **一般信息**
   - 提供有关规范的一般信息，如其在OMG规范体系中的位置和与其他标准的兼容性。

5. **DDSI-RTPS版本2.3**
   - 详细介绍DDSI-RTPS协议的版本2.3，包括其目的、范围和在不同网络环境中的适用性。

6. **PIM（平台独立模型）**
   - 描述RTPS协议的抽象模型，包括结构、消息、行为和发现等模块。

7. **PSM（平台特定模型）：UDP/IP**
   - 定义如何将PIM映射到UDP/IP平台，包括数据类型、消息格式和传输细节。

8. **序列化负载表示**
   - 说明如何序列化和反序列化应用程序数据，以及如何确保发送者和接收者对数据格式有共同的理解。

9. **发现机制**
   - 详细描述了如何自动发现网络中的其他RTPS参与者和端点，以及如何维护它们之间的通信。

10. **QoS和高级DDS特性的实现**
    - 讨论如何使用RTPS实现DDS的服务质量（QoS）参数和高级特性。

11. **附录**
    - 提供了额外的信息，如术语表、参考文献和版本历史。

12. **参考文献**
    - 列出了文档中引用的所有相关标准和规范的详细信息。

整个文档提供了一个全面的指南，用于理解和实现基于DDSI-RTPS的实时数据分发系统。它旨在确保不同厂商实现的DDS系统之间的互操作性，同时保持高效和实时性。


## RTPS协议的概念、目的、范围和在不同网络环境中的适用性

RTPS（Real-Time Publish-Subscribe）协议的概念基于以下几个核心概念：

1. **发布-订阅模型（Publish-Subscribe Model）**：
   - RTPS遵循发布-订阅通信模式，其中数据发布者（Publisher）发送数据而不指定接收者，而订阅者（Subscriber）表达对某些数据的兴趣而不指定发送者。中间的DDS代理（如RTPS Writer和Reader）负责匹配发布者和订阅者并传递数据。

2. **实时性（Real-Time）**：
   - RTPS协议专为实时系统设计，强调数据传输的及时性和可预测性。它支持各种QoS（服务质量）策略，如可靠性、时间限制和带宽管理，以满足实时应用的严格要求。

3. **DDS实体（DDS Entities）**：
   - RTPS协议中定义了一系列的DDS实体，包括域（Domain）、参与者（Participant）、写入者（Writer）、读取者（Reader）和历史缓存（HistoryCache）。这些实体构成了RTPS通信的基本组件。

4. **全局唯一标识符（GUID）**：
   - 每个RTPS实体都有一个全局唯一的标识符（GUID），用于在分布式系统中唯一标识每个实体。GUID对于实现实体的发现、匹配和消息路由至关重要。

5. **消息和子消息（Messages and Submessages）**：
   - RTPS协议通过一系列的消息和子消息来进行通信。消息是由一系列子消息组成的，每个子消息包含特定的信息，如数据、心跳、确认等。

6. **数据序列化和反序列化（Data Serialization and Deserialization）**：
   - RTPS协议支持将数据对象转换为可以在网络上传输的序列化形式，以及将接收到的数据还原为原始形式。这通常涉及到使用如CDR（Common Data Representation）这样的序列化协议。

7. **发现和配置（Discovery and Configuration）**：
   - RTPS协议包括一个发现机制，允许实体在网络上自动发现彼此，并配置通信参数。这使得DDS实体能够动态加入或离开网络，而无需手动配置。

8. **QoS策略（QoS Policies）**：
   - 服务质量（QoS）策略是RTPS协议的一个关键特性，它允许用户定义数据传输的各种属性，如可靠性、寿命、传输优先级和历史记录保持等。

9. **互操作性（Interoperability）**：
   - RTPS协议旨在支持不同DDS实现之间的互操作性，确保来自不同供应商的DDS应用程序能够无缝通信。

这些概念共同构成了RTPS协议的基础，使其成为一个适用于分布式实时系统的灵活、高效和可靠的通信协议。

RTPS（Real-Time Publish-Subscribe）协议的目的、范围和在不同网络环境中的适用性可以从以下几个方面来理解：

1. **目的**：
   - RTPS协议的主要目的是提供一种机制，使得不同的DDS（Data Distribution Service）实现能够在分布式系统中进行高效的实时数据交换。
   - 它旨在支持数据中心的发布-订阅通信模式，确保数据的实时分发和高效传输。

2. **范围**：
   - RTPS定义了一个互操作性线协议，它包括了消息格式、消息交换的语义、数据序列化和反序列化的方法，以及网络发现和配置的机制。
   - 它还规定了如何通过QoS（Quality of Service）策略来控制数据传输的可靠性、时间限制和资源管理。

3. **适用性**：
   - RTPS协议适用于需要实时数据交换的各种网络环境，包括但不限于工业自动化、航空航天、军事和电信领域。
   - 它特别适用于那些对延迟、带宽和可靠性有严格要求的应用场景，如实时控制系统和关键任务通信系统。
   - RTPS能够在多种网络类型上运行，包括局域网（LAN）、广域网（WAN）和互联网，同时支持多种传输层协议，如UDP和TCP。

4. **网络环境的适应性**：
   - RTPS协议设计时考虑了网络的动态性和异构性，能够适应网络参与者的加入和离开，以及网络拓扑的变化。
   - 它通过内置的发现机制支持即插即用（plug-and-play）的功能，使得新的参与者可以轻松地加入现有的DDS网络，而无需进行复杂的配置。
   - 协议还包括了对多播和单播传输的支持，以及对网络分区和不稳定性的容错能力。

总的来说，RTPS协议通过提供一种标准化的、高效的、可靠的通信机制，使得分布式实时系统中的不同DDS实现能够无缝地交换数据，无论它们运行在何种网络环境或使用何种物理传输层协议。


## 平台独立模型 (PIM)

平台独立模型（Platform Independent Model，简称PIM）是一种软件架构概念，它提供了一个抽象层，使得软件可以在不同的硬件和操作系统平台上运行而不做修改。在RTPS（Real-Time Publish-Subscribe）协议的上下文中，PIM具有特定的含义和作用：

1. **抽象层**：PIM定义了RTPS协议的核心概念和行为，而不依赖于任何特定的通信平台或操作系统。这意味着PIM提供了一个抽象的协议规范，它描述了如何实现DDS（Data Distribution Service）的互操作性线协议，而不关心底层的网络细节。

2. **跨平台通信**：通过PIM，开发者可以确保他们的RTPS实现遵循统一的标准，从而实现不同DDS实现之间的互操作性。这允许在多种网络环境和传输层协议（如UDP、TCP等）上实现RTPS协议。

3. **设计与实现分离**：PIM将协议的设计与其在特定平台上的实现分离开来。这样，协议的设计者可以专注于定义协议的行为和功能，而实现者则负责将这些抽象概念映射到具体的技术实现上。

4. **灵活性和扩展性**：PIM允许在不改变现有协议规范的情况下，通过添加新的功能和特性来扩展协议。这种设计使得RTPS协议能够适应未来的需求变化和技术进步。

在RTPS协议中，PIM包括了结构、消息、行为和发现等模块，这些模块共同定义了协议的工作原理和数据传输的规则。PIM的存在使得RTPS协议能够在不同的网络和系统环境中灵活地应用，同时保持一致性和互操作性。

### 平台独立模型 (PIM)的范围

平台独立模型（PIM）是DDSI-RTPS规范中定义的抽象模型，它描述了RTPS协议的核心概念和行为，而不依赖于任何特定的通信平台或操作系统。PIM的大纲包括以下几个主要模块：

1. **结构模块（Structure Module）**：
   - 定义了RTPS实体的结构，包括参与者（Participant）、写入者（Writer）、读取者（Reader）和历史缓存（HistoryCache）。
   - 描述了全局唯一标识符（GUID）的使用，以及如何在网络中唯一标识每个RTPS实体。

2. **消息模块（Messages Module）**：
   - 规定了RTPS消息的内容和结构，包括头部和子消息（Submessages）的格式。
   - 详细说明了各种子消息的用途，如数据（Data）、心跳（Heartbeat）、确认（AckNack）、间隙（Gap）等。

3. **行为模块（Behavior Module）**：
   - 描述了RTPS Writer和Reader之间消息交换的合法序列和时序要求。
   - 定义了如何处理各种消息，包括消息的发送、接收、确认和超时处理。

4. **发现模块（Discovery Module）**：
   - 介绍了如何在DDS域中自动发现其他参与者和端点。
   - 定义了发现机制的工作原理，包括参与者和端点的公告、发现和配置。

5. **版本控制和可扩展性（Versioning and Extensibility）**：
   - 讨论了如何处理RTPS协议的不同版本间的兼容性和扩展性。
   - 规定了如何通过添加新的子消息和参数来扩展协议，同时保持与旧版本的兼容性。

6. **实现DDS QoS和高级特性（Implementing DDS QoS and advanced DDS features）**：
   - 说明了如何使用RTPS实现DDS的服务质量（QoS）策略。
   - 描述了高级DDS特性，如内容过滤、实例状态变化、组有序访问等的实现方法。

7. **数据表示（Data Representation）**：
   - 定义了如何表示和传输用户定义的数据类型。
   - 介绍了序列化负载（SerializedPayload）的格式和表示标识符（RepresentationIdentifier）的使用。

PIM为RTPS协议提供了一个统一的框架，使得在不同的平台和环境中实现的DDS系统能够互相理解和通信。通过PIM，开发者可以确保他们的系统遵循统一的标准，从而实现不同DDS实现之间的互操作性。


### 平台独立模型 (PIM)中结构模块（Structure Module）

在RTPS协议的PIM（平台独立模型）中，结构模块（Structure Module）提供了整个协议的基础框架，定义了协议中使用的主要概念和实体。结构模块的大纲通常包括以下内容：

1. **域（Domain）**：
   - 定义了RTPS中的域概念，它代表了一个独立的通信平面，其中包含一组参与者（Participants）。

2. **参与者（Participant）**：
   - 描述了参与者的属性和功能，它是RTPS中的一个重要实体，代表了一个应用程序或服务。
   - 讨论了如何为参与者分配全局唯一标识符（GUID）。

3. **组（Group）**：
   - 介绍了组的概念，它是参与者内部的一个逻辑集合，用于组织和管理相关的读写实体。

4. **读写实体（Reader and Writer Entities）**：
   - 定义了读写实体的通用属性和它们在数据分发中的角色。
   - 描述了读写实体如何与历史缓存（HistoryCache）交互。

5. **历史缓存（HistoryCache）**：
   - 详细说明了历史缓存的作用，它是RTPS实体用来存储和管理数据变更（CacheChanges）的机制。
   - 讨论了历史缓存的容量、过期策略和访问控制。

6. **数据（Data）和实例（Instance）**：
   - 定义了数据和实例的概念，以及它们如何与读写实体交互。
   - 描述了数据的序列化和反序列化过程。

7. **更改（Change）**：
   - 介绍了更改的概念，它代表了对数据对象的创建、修改或删除操作。
   - 讨论了如何表示和处理不同类型的更改。

8. **唯一标识符（GUID）和实体ID（EntityId）**：
   - 描述了如何使用GUID和EntityId来唯一标识RTPS实体。
   - 讨论了GUID和EntityId的构造和映射规则。

9. **关联和匹配（Matching）**：
   - 定义了参与者、读者和写者之间的关联和匹配规则。
   - 讨论了如何通过主题（Topic）和数据类型（Type）来匹配读写实体。

10. **内置端点（Built-in Endpoints）**：
    - 介绍了RTPS协议内置端点的概念，如发现端点（Discovery Endpoints）和参与者消息端点（Participant Message Endpoints）。
    - 讨论了这些端点在协议中的作用和如何使用它们进行网络发现和通信。

结构模块为RTPS协议的其他部分提供了基础，确保了协议的一致性和可预测性。通过这些定义，PIM使得RTPS能够在不同的网络环境和系统平台上实现高效、可靠的数据分发。
